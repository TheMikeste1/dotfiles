---
- name: Install Go
  hosts: localhost
  vars:
    go_version: 1.24.5
    go_archive: go{{ go_version }}.linux-amd64.tar.gz
    go_download_url: "https://go.dev/dl/{{ go_archive }}"
    go_install_path: /usr/local
    go_symlink_path: /usr/local/go
  tasks:
    - name: Download Go archive
      ansible.builtin.get_url:
        url: '{{ go_download_url }}'
        dest: /tmp/{{ go_archive }}
        mode: '0644'
    - name: Ensure go install is absent before extraction
      ansible.builtin.file:
        path: '{{ go_install_path }}/go'
        state: absent
      become: true
    - name: Extract Go archive to /usr/local
      ansible.builtin.unarchive:
        src: /tmp/{{ go_archive }}
        dest: '{{ go_install_path }}'
      become: true
    - name: Remove downloaded Go archive
      ansible.builtin.file:
        path: /tmp/{{ go_archive }}
        state: absent
